<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Browse Projects | Talentrock</title>
    <link rel="stylesheet" th:href="@{/css/style.css}" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
</head>

<body>
    <div class="app-layout">
        <div th:replace="~{fragments/freelancer-sidebar :: freelancer-sidebar}"></div>

        <main class="main-content">
            <div class="page-header">
                <h1 class="page-title">Browse Projects üîç</h1>
                <p class="page-subtitle">Find the perfect project that matches your skills</p>
            </div>

            <div th:if="${success}" class="alert alert-success">‚úÖ <span th:text="${success}"></span></div>
            <div th:if="${error}" class="alert alert-error">‚ö†Ô∏è <span th:text="${error}"></span></div>

            <!-- Search & Filter -->
            <div class="card mb-4">
                <div class="card-body">
                    <form th:action="@{/freelancer/browse}" method="get" class="flex flex-wrap gap-2">
                        <div class="form-group mb-0 flex-1" style="min-width:300px;">
                            <input type="text" name="keyword" class="form-control" th:value="${keyword}"
                                placeholder="Search by skill, title, or keywords..." />
                        </div>
                        <div class="form-group mb-0" style="min-width:200px;">
                            <select name="category" class="form-control">
                                <option value="">All Categories</option>
                                <optgroup label="Development & IT">
                                    <option th:selected="${category == 'Web Development'}">Web Development</option>
                                    <option th:selected="${category == 'Mobile Apps'}">Mobile Apps</option>
                                    <option th:selected="${category == 'Android Apps'}">Android Apps</option>
                                    <option th:selected="${category == 'iPhone Apps'}">iPhone Apps</option>
                                    <option th:selected="${category == 'Software Architecture'}">Software Architecture
                                    </option>
                                    <option th:selected="${category == 'HTML'}">HTML</option>
                                    <option th:selected="${category == 'CSS'}">CSS</option>
                                    <option th:selected="${category == 'HTML 5'}">HTML 5</option>
                                    <option th:selected="${category == 'Javascript'}">Javascript</option>
                                    <option th:selected="${category == 'Python'}">Python</option>
                                    <option th:selected="${category == 'PHP'}">PHP</option>
                                    <option th:selected="${category == 'C++ Programming'}">C++ Programming</option>
                                    <option th:selected="${category == 'C# Programming'}">C# Programming</option>
                                    <option th:selected="${category == 'MySQL'}">MySQL</option>
                                    <option th:selected="${category == 'Wordpress'}">Wordpress</option>
                                    <option th:selected="${category == 'Data Processing'}">Data Processing</option>
                                    <option th:selected="${category == 'Web Scraping'}">Web Scraping</option>
                                    <option th:selected="${category == 'Linux'}">Linux</option>
                                </optgroup>
                                <optgroup label="Design & Creative">
                                    <option th:selected="${category == 'Website Design'}">Website Design</option>
                                    <option th:selected="${category == 'Graphic Design'}">Graphic Design</option>
                                    <option th:selected="${category == 'Logo Design'}">Logo Design</option>
                                    <option th:selected="${category == 'UI/UX Design'}">UI/UX Design</option>
                                    <option th:selected="${category == 'Banner Design'}">Banner Design</option>
                                    <option th:selected="${category == 'Illustration'}">Illustration</option>
                                    <option th:selected="${category == '3D Modelling'}">3D Modelling</option>
                                    <option th:selected="${category == 'Photoshop'}">Photoshop</option>
                                    <option th:selected="${category == 'Video Editing'}">Video Editing</option>
                                </optgroup>
                                <optgroup label="Writing & Content">
                                    <option th:selected="${category == 'Content Writing'}">Content Writing</option>
                                    <option th:selected="${category == 'Article Writing'}">Article Writing</option>
                                    <option th:selected="${category == 'Research Writing'}">Research Writing</option>
                                    <option th:selected="${category == 'Copywriting'}">Copywriting</option>
                                    <option th:selected="${category == 'Ghostwriting'}">Ghostwriting</option>
                                    <option th:selected="${category == 'Technical Writing'}">Technical Writing</option>
                                    <option th:selected="${category == 'Blogging'}">Blogging</option>
                                    <option th:selected="${category == 'Proofreading'}">Proofreading</option>
                                    <option th:selected="${category == 'Translation'}">Translation</option>
                                </optgroup>
                                <optgroup label="Sales & Marketing">
                                    <option th:selected="${category == 'Digital Marketing'}">Digital Marketing</option>
                                    <option th:selected="${category == 'Marketing'}">Marketing</option>
                                    <option th:selected="${category == 'SEO & Analytics'}">SEO & Analytics</option>
                                    <option th:selected="${category == 'Link Building'}">Link Building</option>
                                    <option th:selected="${category == 'Internet Marketing'}">Internet Marketing
                                    </option>
                                    <option th:selected="${category == 'Public Relations'}">Public Relations</option>
                                </optgroup>
                                <optgroup label="Business & Admin">
                                    <option th:selected="${category == 'Data Entry'}">Data Entry</option>
                                    <option th:selected="${category == 'Excel'}">Excel</option>
                                    <option th:selected="${category == 'Accounting'}">Accounting</option>
                                    <option th:selected="${category == 'Finance'}">Finance</option>
                                    <option th:selected="${category == 'Legal'}">Legal</option>
                                    <option th:selected="${category == 'Logistics'}">Logistics</option>
                                    <option th:selected="${category == 'Research'}">Research</option>
                                    <option th:selected="${category == 'Web Search'}">Web Search</option>
                                    <option th:selected="${category == 'Manufacturing'}">Manufacturing</option>
                                    <option th:selected="${category == 'eCommerce'}">eCommerce</option>
                                </optgroup>
                                <option th:selected="${category == 'Other'}">Other</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-primary">Filter Results</button>
                    </form>
                </div>
            </div>

            <!-- Projects Grid -->
            <div th:if="${projects == null or projects.isEmpty()}"
                style="text-align:center; padding:4rem 2rem; color:var(--text-muted);">
                <div style="font-size:4rem; margin-bottom:1rem;">üì≠</div>
                <h3 style="margin-bottom:0.5rem;">No projects found</h3>
                <p class="text-sm">Try a different search, or check back later for new opportunities</p>
            </div>

            <div class="grid grid-2" th:if="${projects != null and !projects.isEmpty()}">
                <div th:each="project : ${projects}" class="project-card">
                    <div class="flex-between mb-3">
                        <span class="project-badge badge-open">üü¢ Open</span>
                        <span class="text-muted text-xs"
                            th:text="${project.createdAt != null ? #temporals.format(project.createdAt, 'dd MMM yyyy') : ''}">Date</span>
                    </div>
                    <h3 style="font-size:1.1rem; margin-bottom:0.5rem;" th:text="${project.title}">Project Title</h3>
                    <p class="text-secondary-color text-sm mb-3"
                        style="line-height:1.6; display:-webkit-box; -webkit-line-clamp:3; line-clamp:3; -webkit-box-orient:vertical; overflow:hidden;"
                        th:text="${project.description}">Description</p>

                    <div class="flex flex-wrap gap-1 mb-3" th:if="${project.skillsRequired}">
                        <span th:each="skill : ${project.skillsRequired.split(',')}"
                            style="background:rgba(108,99,255,0.12); color:var(--primary-light); padding:3px 10px; border-radius:100px; font-size:0.75rem; font-weight:500;"
                            th:text="${skill.trim()}">Skill</span>
                    </div>

                    <div class="flex-between items-center">
                        <div>
                            <span style="font-weight:700; color:var(--secondary);">
                                ‚Çπ<span th:text="${#numbers.formatDecimal(project.budgetMin, 1, 0)}">0</span>
                                ‚Äì ‚Çπ<span th:text="${#numbers.formatDecimal(project.budgetMax, 1, 0)}">0</span>
                            </span>
                            <span th:if="${project.deadline}" class="text-muted text-xs" style="margin-left:8px;">
                                üìÖ <span th:text="${#temporals.format(project.deadline, 'dd MMM')}">Date</span>
                            </span>
                        </div>
                        <div class="flex items-center gap-2">
                            <span class="text-muted text-xs"
                                th:text="${project.bids != null ? project.bids.size() + ' bids' : '0 bids'}">Bids</span>
                            <a th:href="@{/freelancer/project/{id}(id=${project.id})}"
                                class="btn btn-primary btn-sm">Bid Now ‚Üí</a>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
</body>

</html>